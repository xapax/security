<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="xapax">
    
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Cross-site Scripting - Notes</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Cross-site-scripting", url: "#_top", children: [
              {title: "Finding XSS - Polyglot", url: "#finding-xss-polyglot" },
              {title: "So, what's the worst that can happen?", url: "#so-whats-the-worst-that-can-happen" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../web-scanning/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../web-scanning/" class="btn btn-xs btn-link">
        Find Files
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../cross_site_request_forgery/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../cross_site_request_forgery/" class="btn btn-xs btn-link">
        Cross-site Request Forgery
      </a>
    </div>
    
  </div>

    

    <h1 id="cross-site-scripting">Cross-site-scripting<a class="headerlink" href="#cross-site-scripting" title="Permanent link">#</a></h1>
<p>Cross-site-scripting, or XSS as it is sometimes abbreviated to, is an attack that let's the attacker execute javascript code in the browser of the victim.</p>
<h2 id="finding-xss-polyglot">Finding XSS - Polyglot<a class="headerlink" href="#finding-xss-polyglot" title="Permanent link">#</a></h2>
<pre><code>jaVasCript:/*-/*`/*\`/*'/*&quot;/**/(/* */oNcliCk=alert() )//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;\x3csVg/&lt;sVg/oNloAd=alert()//&gt;\x3e
</code></pre>

<p>https://github.com/0xsobky/HackVault/wiki/Unleashing-an-Ultimate-XSS-Polyglot</p>
<h2 id="so-whats-the-worst-that-can-happen">So, what's the worst that can happen?<a class="headerlink" href="#so-whats-the-worst-that-can-happen" title="Permanent link">#</a></h2>
<p>The attacker is probably not that interested in changing the color or font of the website the victim is visiting. Although s/he could do that. The worst that can happen is probably the following:</p>
<ol>
<li>
<p>Complete control over the browser
The attacker can access plugins. Like password managers. The attacker can trick the user into allowing webcam or audio. </p>
</li>
<li>
<p>Session-hijacking/Cookie theft
This is when the attacker steals the cookie that is saved in the browser. Using this cookie the attacker can log in to the service as the victim, and thereby gain access to his/her account. If the victim is an admin that has extended privileges (uploading code, images, or whatever) this could lead to a compromise of the server itself.</p>
</li>
<li>
<p>Keylogger
The attacker can execute a keylogging-script that steals everything the user inputs in the website. This could be used to steal sensitive information, like passwords, credit cards information, chatlogs or whatever the user inputs.</p>
</li>
<li>
<p>Phishing
The attacker can insert a fake login. Image that you visit a site, and from that site you are able to login using your facebook or google-account. The attacker could spoof that so that when you enter your credentials, they are then sent to the attacker. </p>
</li>
</ol>
<h3 id="types-of-xss">Types of XSS<a class="headerlink" href="#types-of-xss" title="Permanent link">#</a></h3>
<ol>
<li>
<p>Persistent
This is when the malicious code originates from the websites database. That means the attacker has managed to insert malicious code into the database. So every time the database serve that data the script will me executed. this is probably the most dangerous XSS, since it does not need to rely on social engineering.</p>
</li>
<li>
<p>Reflected
This is an attack where the script originates from the users request. This might seem a bit illogical, why would a user inject malicious code to himself? Well the code can </p>
</li>
<li>
<p>DOM based
DOM-based attacks are when something is injected into javascript on the DOM. So, it does not go by the server. Because the code gets executed in the response.
Take a search-functionality for example. The users enters a search-parameter that gets sent to the server which might sanitize it or something. In the response the found search-items are sent, but not the search-query. But on the webpage the search query is exposed. "You searched for X" is shown. That is because it gets the search parameter from the url-parameter. By using <code>document.location.href</code> for example.</p>
</li>
</ol>
<h3 id="protect-yourself">Protect yourself<a class="headerlink" href="#protect-yourself" title="Permanent link">#</a></h3>
<p>The problem with XSS is that it is a bit hard for the users to protect themselves. If there is a problem witht the website there is not that much the user can do.</p>
<p>One can always use noscript to block all javascript code. But that pretty much destroys the whole experience with using the internet.</p>
<h3 id="protect-your-website">Protect your website<a class="headerlink" href="#protect-your-website" title="Permanent link">#</a></h3>
<p>There are mainly two ways to protect against <strong> encoding </strong> and <strong> sanitizing </strong>.</p>
<h3 id="references">References:<a class="headerlink" href="#references" title="Permanent link">#</a></h3>
<p>http://brutelogic.com.br/blog/probing-to-find-xss/
http://excess-xss.com/</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../web-scanning/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../web-scanning/" class="btn btn-xs btn-link">
        Find Files
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../cross_site_request_forgery/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../cross_site_request_forgery/" class="btn btn-xs btn-link">
        Cross-site Request Forgery
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
      <p>
        <a href="https://github.com/xapax/edit/master/docs/attacking_web_applications/cross-site-scripting.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>